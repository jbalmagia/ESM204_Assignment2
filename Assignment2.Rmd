---
title: "ESM204 Assignment 2"
author: "Jenny Balmagia"
date: "April 25, 2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
#Load Packages 

library(tidyverse)

#Read in data
#Natalie tidied in Excel

gas <- read_csv("Gas_Data.csv")

```

1. What is the aggregate daily demand curve for gasoline in France? What is the
supply curve for gasoline? What is the “benefit” to consumers under the status
quo? What is the “benefit” to producers under the status quo? What is the
environmental cost under the status quo?

```{r}
#y = mx + b -> P = mQ + b
#Demand curve for High:
High <- lm(price ~ high, data = gas)
summary(High)
bH <- High$coefficients[1] #intercept
mH <- High$coefficients[2] #slope

#Demand curve for Low: 
Low <- lm(price ~ low, data = gas)
summary(Low)
bL <- Low$coefficients[1] #intercept
mL <- Low$coefficients[2] #slope

#High demand in terms of quantity (Q)
Q_high1 <- 1/mH
Q_high2 <- bH/mH

#Low demand in terms of quantity (Q)
Q_low1 <- 1/mL
Q_low2 <- bL/mL

#Aggregate in terms of Q (because its in terms of Q we're adding horizontally)
Q_agg1 <- Q_high1 + Q_low1
Q_agg2 <- Q_high2 + Q_low2

#Aggregate in terms of price (P)
P_agg1 <- 1/Q_agg1
P_agg2 <- Q_agg2/Q_agg1

#Demand Curves
demand_h <- function(q) {mH*q + bH}
demand_l <- function(q) {mL*q + bL}
demand_agg<- function(q) {P_agg1*q + P_agg2} 

#Calculate supply curve
Q_equil <- 5*Q_agg1 - Q_agg2 #Get quantity at equilibrium, P = 5 (given)
supp_slope <- 5/Q_equil #Get slope of supply curve, no b since intercept is 0

#Supply curve 
supply <- function(q) {supp_slope*q}

#Marginal environmental cost curve
mec <- function(q) {q*0 + 2} #since it's a flat line

#vector to use in functions

q <- 70000:350000

gas_curves <- data.frame(high = demand_h(q), 
                         low = demand_l(q), 
                         aggregate = demand_agg(q), 
                         sup = supply(q),
                         quantity = q,
                         MEC = mec(q))

###Need to graph next

gas_graph <- ggplot(data = gas_curves)+
  geom_line(aes(x = q, y = high))+
  geom_line(aes(x = q, y = low))+
  geom_line(aes(x = q, y = sup))+
  geom_line(aes(x = q, y = MEC))+
  geom_line(aes(x = q, y = aggregate))

gas_graph

#Finding the areas of triangles (CS and PS)

#Low Demand CS
Base_Low <- uniroot(function(q) demand_l(q) - 5, lower = 0, upper = 350000)$root 
Height_Low <- bL - 5
cs_low <- Base_Low*Height_Low*0.5
cs_low

#High Demand CS
Base_High <- uniroot(function(q) demand_h(q) - 5, lower = 0, upper = 350000)$root
Height_High <- bH - 5
cs_high <- Base_High*Base_Low*0.5

#Aggregate Demand CS
cs_agg <- cs_high + cs_low

#PS
ps <- Q_equil*5*0.5


```

2. How is the current consumer benefit divided between “High” and “Low” income
consumers?

```{r}

```

3. A gas tax of $0.50/gal. is proposed. What would be the effects of this tax on:
a. The amount of gasoline produced and sold in France.
b. The price of gasoline.
c. Welfare of “High” income consumers.
d. Welfare of “Low” income consumers.
e. Welfare of gas producers.
f. Total environmental damage.
g. Total revenue generated by the tax.

```{r}

```

4. Now, assume that all revenue from a tax will be used for infrastructure repairs,
and that the benefit of this is proportional to the amount you drive (i.e. to the gas
you consume). Also assume that “Low” income consumers bear all
environmental costs. For a range of gas taxes (ranging from $0 - $5.00/gal),
calculate the effects of the tax on:
a. Overall welfare of “High” income consumers
b. Overall welfare of “Low” income consumers
c. Gas producers

```{r}

```

5. Finally, assume that electric cars will gain popularity and that in the future this
will lower the demand curves of all income groups by half (vertically). Under
these new demand curves, what are the effects on:
a. Gas consumption by “High” income consumers
b. Gas consumption by “Low” income consumers
c. Gas price
d. Environmental damage from gasoline

```{r}


```

6. Using these numbers, which has a bigger impact on environmental quality, a
$2.00/gal. gas tax or the invention of electric cars? Provide your evidence.
